# Village Homepage - Development Environment Configuration
#
# IMPORTANT: This file contains EXAMPLE values only. Copy it to .env and customize:
#   cp .env.example .env
#
# NEVER commit .env to version control - it is git-ignored by default.
# For production secrets management, refer to the ../villagecompute repository
# infrastructure configurations and follow the VillageCompute security baseline.
#
# See docs/ops/dev-services.md for detailed service configuration guidance.

# ==============================================================================
# PostgreSQL 17 + PostGIS Configuration (P6)
# ==============================================================================
# Primary relational database with geospatial capabilities
# Production: Managed HA pair with streaming replication and automatic failover
# Development: Single instance via docker-compose

POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=village_homepage
POSTGRES_USER=village
POSTGRES_PASSWORD=village_dev_pass

# Database connection pool settings (Quarkus datasource)
QUARKUS_DATASOURCE_JDBC_URL=jdbc:postgresql://localhost:5432/village_homepage
QUARKUS_DATASOURCE_USERNAME=village
QUARKUS_DATASOURCE_PASSWORD=village_dev_pass
QUARKUS_DATASOURCE_JDBC_MIN_SIZE=5
QUARKUS_DATASOURCE_JDBC_MAX_SIZE=20

# ==============================================================================
# Elasticsearch 8 Configuration (P6)
# ==============================================================================
# Full-text search engine for Hibernate Search indices
# Used for marketplace listings and web directory site search with geo-spatial filtering
# Production: Dedicated StatefulSet with SSD-backed volumes
# Development: Single-node cluster via docker-compose

ELASTICSEARCH_HOST=localhost
ELASTICSEARCH_PORT=9200
QUARKUS_HIBERNATE_SEARCH_ORM_ELASTICSEARCH_HOSTS=localhost:9200
QUARKUS_HIBERNATE_SEARCH_ORM_ELASTICSEARCH_PROTOCOL=http
QUARKUS_HIBERNATE_SEARCH_ORM_ELASTICSEARCH_USERNAME=
QUARKUS_HIBERNATE_SEARCH_ORM_ELASTICSEARCH_PASSWORD=

# ==============================================================================
# MinIO Configuration (S3-Compatible Object Storage)
# ==============================================================================
# Development equivalent of Cloudflare R2
# Stores listing images and screenshot captures
# Production: Cloudflare R2 with CDN distribution
# Development: Local MinIO instance via docker-compose

MINIO_API_PORT=9000
MINIO_CONSOLE_PORT=9001
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin

# S3 client configuration (used by Quarkus application)
# PRODUCTION: Cloudflare R2 (S3-compatible) credentials
# PRODUCTION: Kubernetes secret 'homepage-s3-credentials'
# SECURITY: Rotate R2 access keys quarterly, see docs/ops/security.md
S3_ENDPOINT=http://localhost:9000
S3_ACCESS_KEY=minioadmin
S3_SECRET_KEY=minioadmin
S3_REGION=us-east-1
S3_BUCKET_SCREENSHOTS=screenshots
S3_BUCKET_LISTINGS=listings
# Production R2 endpoint (comment out for local dev)
# S3_ENDPOINT=https://<account-id>.r2.cloudflarestorage.com

# ==============================================================================
# Mailpit Configuration (SMTP Testing)
# ==============================================================================
# Development SMTP server with web UI for email testing
# Production: Managed SMTP relay (see ../villagecompute for credentials)
# Development: Mailpit via docker-compose

MAILPIT_SMTP_PORT=1025
MAILPIT_UI_PORT=8025

# Quarkus mailer configuration
QUARKUS_MAILER_FROM=noreply@villagecompute.com
QUARKUS_MAILER_HOST=localhost
QUARKUS_MAILER_PORT=1025
QUARKUS_MAILER_USERNAME=
QUARKUS_MAILER_PASSWORD=
QUARKUS_MAILER_TLS=false
QUARKUS_MAILER_AUTH=false

# ==============================================================================
# Jaeger Configuration (Distributed Tracing)
# ==============================================================================
# OpenTelemetry trace collection and visualization
# Production: Centralized Jaeger cluster
# Development: All-in-one Jaeger instance via docker-compose

JAEGER_UI_PORT=16686
JAEGER_COLLECTOR_PORT=4317
JAEGER_COLLECTOR_HTTP_PORT=4318

# Quarkus OpenTelemetry configuration
QUARKUS_OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
QUARKUS_OTEL_SERVICE_NAME=village-homepage
QUARKUS_OTEL_TRACES_ENABLED=true

# ==============================================================================
# External API Keys (P3, P5, P13, P14)
# ==============================================================================
# These APIs are used for homepage widgets and integrations
# IMPORTANT: Replace these placeholder values with real API keys from providers
# PRODUCTION: Store in Kubernetes secret 'homepage-external-api-credentials'
# SECURITY: Rotate keys quarterly, emergency rotation in docs/ops/security.md

# Alpha Vantage - Stock market data (stocks widget)
# Get free API key at: https://www.alphavantage.co/support/#api-key
# PRODUCTION: Kubernetes secret key 'alpha-vantage-api-key'
ALPHA_VANTAGE_API_KEY=YOUR_ALPHA_VANTAGE_API_KEY_HERE

# Open-Meteo - Weather data (international, no API key required)
# National Weather Service - Weather data (US, no API key required)
# No configuration needed - public APIs

# Meta Graph API - Instagram/Facebook integration (social feed widget) (P5, P13)
# Get credentials at: https://developers.facebook.com/
# PRODUCTION: Kubernetes secret 'homepage-meta-credentials'
# SECURITY: Social tokens encrypted at rest via Quarkus Vault/KMS, never logged
META_APP_ID=YOUR_META_APP_ID_HERE
META_APP_SECRET=YOUR_META_APP_SECRET_HERE

# LangChain4j - AI integration for RSS feed tagging (P14)
# Configure provider-specific credentials (OpenAI, Anthropic, etc.)
# See docs/ops/ai-integration.md for provider setup guidance
# PRODUCTION: Kubernetes secret 'homepage-langchain4j-credentials'
# SECURITY: Model-agnostic; rotate provider keys quarterly
LANGCHAIN4J_PROVIDER=openai
LANGCHAIN4J_API_KEY=YOUR_AI_PROVIDER_API_KEY_HERE
LANGCHAIN4J_MODEL_NAME=gpt-4o-mini

# ==============================================================================
# Stripe - Payment processing for marketplace featured listings (P3, P14)
# ==============================================================================
# Get test keys at: https://dashboard.stripe.com/test/apikeys
# PRODUCTION: Store in Kubernetes secret 'homepage-stripe-credentials'
# SECURITY: Rotate keys quarterly, emergency rotation playbook in docs/ops/security.md
STRIPE_PUBLISHABLE_KEY=pk_test_YOUR_PUBLISHABLE_KEY_HERE
STRIPE_SECRET_KEY=sk_test_YOUR_SECRET_KEY_HERE
STRIPE_WEBHOOK_SECRET=whsec_YOUR_WEBHOOK_SECRET_HERE

# ==============================================================================
# OAuth Provider Configuration (P1, P9, P14)
# ==============================================================================
# User authentication via Google, Facebook, Apple Sign-In (Quarkus OIDC)
# Get credentials from respective developer consoles
# PRODUCTION: Store client secrets in Kubernetes secret 'homepage-oauth-credentials'
# SECURITY: Rotate OAuth secrets quarterly, see docs/ops/security.md

# Google OAuth
GOOGLE_CLIENT_ID=YOUR_GOOGLE_CLIENT_ID_HERE
GOOGLE_CLIENT_SECRET=YOUR_GOOGLE_CLIENT_SECRET_HERE
QUARKUS_OIDC_GOOGLE_CLIENT_ID=${GOOGLE_CLIENT_ID}
QUARKUS_OIDC_GOOGLE_CREDENTIALS_SECRET=${GOOGLE_CLIENT_SECRET}

# Facebook OAuth
FACEBOOK_APP_ID=YOUR_FACEBOOK_APP_ID_HERE
FACEBOOK_APP_SECRET=YOUR_FACEBOOK_APP_SECRET_HERE
QUARKUS_OIDC_FACEBOOK_CLIENT_ID=${FACEBOOK_APP_ID}
QUARKUS_OIDC_FACEBOOK_CREDENTIALS_SECRET=${FACEBOOK_APP_SECRET}

# Apple Sign-In
APPLE_CLIENT_ID=YOUR_APPLE_CLIENT_ID_HERE
APPLE_TEAM_ID=YOUR_APPLE_TEAM_ID_HERE
APPLE_KEY_ID=YOUR_APPLE_KEY_ID_HERE
APPLE_PRIVATE_KEY_PATH=/path/to/apple-private-key.p8
QUARKUS_OIDC_APPLE_CLIENT_ID=${APPLE_CLIENT_ID}
QUARKUS_OIDC_APPLE_CREDENTIALS_SECRET=${APPLE_PRIVATE_KEY_PATH}

# ==============================================================================
# Application Configuration (P1, P9, P14)
# ==============================================================================

# Bootstrap superuser creation URL token (P1)
# IMPORTANT: Generate a secure random token for production (min 32 chars)
# Used for first-time superuser account creation (see docs/ops/bootstrap.md)
# PRODUCTION: Kubernetes secret 'homepage-bootstrap-credentials' key 'superuser-token'
# SECURITY: Single-use token; rotates after first superuser creation
# Generate with: openssl rand -hex 32
BOOTSTRAP_SUPERUSER_TOKEN=dev_bootstrap_token_change_in_production

# Session secret (used for JWT signing) (P9)
# IMPORTANT: Generate a secure random string for production (min 64 chars)
# PRODUCTION: Kubernetes secret 'homepage-jwt-credentials' key 'jwt-secret'
# SECURITY: Rotate annually or on suspected compromise; invalidates all sessions
# Generate with: openssl rand -base64 64
JWT_SECRET=dev_jwt_secret_change_in_production_minimum_32_chars

# Anonymous account cookie configuration (P9)
# Cookie name for anonymous user tracking (HttpOnly, Secure, SameSite=Lax)
ANONYMOUS_COOKIE_NAME=vu_anon_id
ANONYMOUS_COOKIE_MAX_AGE=31536000
# Cookie security attributes (always true in production)
COOKIE_SECURE=false
COOKIE_HTTP_ONLY=true
COOKIE_SAME_SITE=Lax

# Application URLs
APP_BASE_URL=http://localhost:8080
APP_FRONTEND_URL=http://localhost:8080

# Feature flags (initial state - see migrations for feature flag seeding)
FEATURE_STOCKS_WIDGET=false
FEATURE_SOCIAL_INTEGRATION=false
FEATURE_PROMOTED_LISTINGS=false

# Rate limiting defaults (override via admin dashboard)
RATE_LIMIT_ENABLED=true
RATE_LIMIT_DEFAULT_REQUESTS_PER_HOUR=1000

# ==============================================================================
# Development Tooling
# ==============================================================================

# Quarkus development mode settings
QUARKUS_HTTP_PORT=8080
QUARKUS_LOG_LEVEL=INFO
QUARKUS_LOG_CONSOLE_FORMAT=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n

# Enable Hibernate SQL logging (for development debugging)
QUARKUS_HIBERNATE_ORM_LOG_SQL=false
QUARKUS_HIBERNATE_ORM_LOG_BIND_PARAMETERS=false

# MyBatis Migrations environment
MIGRATION_ENV=development

# ==============================================================================
# Security & Secret Management (P1, P3, P9, P14)
# ==============================================================================

# Quarkus Vault integration (optional - for advanced secret management)
# Uncomment and configure when using HashiCorp Vault for secret injection
# QUARKUS_VAULT_URL=http://localhost:8200
# QUARKUS_VAULT_AUTHENTICATION_KUBERNETES_ROLE=homepage-app
# QUARKUS_VAULT_KV_SECRET_CONFIG_V2_PATH=homepage

# Secret encryption (for social tokens, Stripe keys at rest in database)
# IMPORTANT: Generate a 256-bit AES key for production
# Generate with: openssl rand -hex 32
# PRODUCTION: Kubernetes secret 'homepage-encryption-credentials' key 'encryption-key'
SECRET_ENCRYPTION_KEY=dev_encryption_key_change_in_production_must_be_32_bytes_hex

# Rate limiting secret (HMAC signing for rate limit tokens)
# PRODUCTION: Kubernetes secret 'homepage-rate-limit-credentials' key 'hmac-secret'
# Generate with: openssl rand -base64 32
RATE_LIMIT_HMAC_SECRET=dev_rate_limit_hmac_secret_change_in_production

# ==============================================================================
# Compliance & Data Governance (P1, P14)
# ==============================================================================

# GDPR/CCPA consent management
# Enable consent modal on first visit (P1)
ENABLE_CONSENT_MODAL=true
CONSENT_COOKIE_NAME=vu_consent
CONSENT_COOKIE_MAX_AGE=31536000

# Data retention windows (P4, P5, P13, P14)
# Audit log retention (days) - 90 days per blueprint
AUDIT_LOG_RETENTION_DAYS=90
# Screenshot retention (days) - indefinite per P4 (set to 0 to disable cleanup)
SCREENSHOT_RETENTION_DAYS=0
# Social data retention (days) - indefinite per P5/P13 (set to 0 to disable cleanup)
SOCIAL_DATA_RETENTION_DAYS=0
# Soft delete purge timer (days) - 90 days per blueprint
SOFT_DELETE_PURGE_DAYS=90
