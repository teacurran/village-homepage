[
  {
    "task_id": "I2.T1",
    "iteration_id": "I2",
    "iteration_goal": "Translate architectural artifacts into actionable specs for personalized homepage delivery, covering user preference schemas, widget contracts, consent/merge UX flows, and initial OpenAPI definitions so frontend/backend squads can begin implementation in parallel.",
    "description": "Build the Homepage Requirements Backlog document summarizing widget capabilities, layouts per device, personalization rules, and default anonymous experiences. Include acceptance criteria for each widget (news, weather, stocks, social, quick links, RSS, search) referencing policies (P1, P2, P5, P9, P13) and mapping to user preference fields.",
    "agent_type_hint": "ProductDocumentationAgent",
    "inputs": "Architecture intake, Section 1 requirements, job blueprint.",
    "target_files": [
      "docs/ui-guides/widget_matrix.md"
    ],
    "input_files": [
      "docs/architecture/architecture_intake.md",
      "CLAUDE.md"
    ],
    "deliverables": "Widget matrix with columns for state coverage, data sources, feature flags, merge behavior, instrumentation, rate limits, and dependencies.",
    "acceptance_criteria": "Matrix covers all widget types, ties each to relevant policy IDs and delayed job triggers, and highlights analytics/feature flag requirements.",
    "dependencies": [
      "I1.T1"
    ],
    "parallelizable": true,
    "done": false
  },
  {
    "task_id": "I2.T2",
    "iteration_id": "I2",
    "iteration_goal": "Translate architectural artifacts into actionable specs for personalized homepage delivery, covering user preference schemas, widget contracts, consent/merge UX flows, and initial OpenAPI definitions so frontend/backend squads can begin implementation in parallel.",
    "description": "Produce OpenAPI v1 draft covering authentication bootstrap, anonymous ID issuance, user preferences CRUD, widget data fetch endpoints, and `/track/click` instrumentation payloads. Include error models, rate limit headers, and examples for each endpoint.",
    "agent_type_hint": "BackendAgent",
    "inputs": "ERD, widget matrix, feature flag/rate limit playbooks.",
    "target_files": [
      "api/openapi.yaml"
    ],
    "input_files": [
      "docs/architecture/data_model.puml",
      "docs/ui-guides/widget_matrix.md",
      "docs/ops/feature_flag_playbook.md",
      "docs/ops/rate_limit_playbook.md"
    ],
    "deliverables": "OpenAPI YAML with security schemes, schemas for UserPreferencesType, WidgetResponseType, Consent payloads, and ClickTrackingType.",
    "acceptance_criteria": "Spec validates via `openapi-generator` or `spectral`, covers all endpoints required by homepage widgets, includes policy-relevant headers (consent, rate limits), and references DTO anchors.",
    "dependencies": [
      "I2.T1"
    ],
    "parallelizable": false,
    "done": false
  },
  {
    "task_id": "I2.T3",
    "iteration_id": "I2",
    "iteration_goal": "Translate architectural artifacts into actionable specs for personalized homepage delivery, covering user preference schemas, widget contracts, consent/merge UX flows, and initial OpenAPI definitions so frontend/backend squads can begin implementation in parallel.",
    "description": "Design database migration plan and schema notes for user preference storage (`users.preferences` JSONB), anonymous user lifecycle (Policy P9), feature flag evaluation retention, and click tracking partitions specific to homepage interactions.",
    "agent_type_hint": "DatabaseAgent",
    "inputs": "ERD, OpenAPI draft, governance docs.",
    "target_files": [
      "migrations/notes/iteration2_prefs_and_flags.md"
    ],
    "input_files": [
      "docs/architecture/data_model.puml",
      "api/openapi.yaml",
      "docs/ops/feature_flag_playbook.md"
    ],
    "deliverables": "Migration note with table/column definitions, JSONB schema versioning plan, indexes, retention jobs, and test strategies.",
    "acceptance_criteria": "Document lists SQL statements for new columns/indexes, describes migration ordering, identifies rollback steps, and references policies P1, P7, P14.",
    "dependencies": [
      "I2.T2"
    ],
    "parallelizable": false,
    "done": false
  },
  {
    "task_id": "I2.T4",
    "iteration_id": "I2",
    "iteration_goal": "Translate architectural artifacts into actionable specs for personalized homepage delivery, covering user preference schemas, widget contracts, consent/merge UX flows, and initial OpenAPI definitions so frontend/backend squads can begin implementation in parallel.",
    "description": "Specify consent + anonymous merge UX (copy, modals, flows, decision states). Deliver flow diagrams for OAuth merge, GDPR consent options, anonymous data discard, and audit logging triggers.",
    "agent_type_hint": "UXDocumentationAgent",
    "inputs": "Policy decisions P1, P9, Section 6 assumptions, widget requirements.",
    "target_files": [
      "docs/ui-guides/consent_flows.mmd",
      "docs/ui-guides/consent_copy.md"
    ],
    "input_files": [
      "docs/ui-guides/widget_matrix.md",
      "docs/architecture/architecture_intake.md"
    ],
    "deliverables": "Mermaid sequence diagram, copy matrix, banner text, error states, and event logging checklist.",
    "acceptance_criteria": "Flow covers accepted/declined/partial merges, references audit table fields, includes accessibility copy, and ties to OpenAPI endpoints.",
    "dependencies": [
      "I2.T1"
    ],
    "parallelizable": true,
    "done": false
  },
  {
    "task_id": "I2.T5",
    "iteration_id": "I2",
    "iteration_goal": "Translate architectural artifacts into actionable specs for personalized homepage delivery, covering user preference schemas, widget contracts, consent/merge UX flows, and initial OpenAPI definitions so frontend/backend squads can begin implementation in parallel.",
    "description": "Scaffold TypeScript/React mount architecture: define `mounts.ts` registry pattern, shared hooks, widget skeleton components, and telemetry wrappers. Provide coding standards (naming, props validation, data-component usage) for islands.",
    "agent_type_hint": "FrontendAgent",
    "inputs": "Build scaffolding (I1.T2), widget matrix, OpenAPI spec.",
    "target_files": [
      "src/main/resources/META-INF/resources/assets/ts/mounts.ts",
      "docs/ui-guides/ts_architecture.md"
    ],
    "input_files": [
      "README.md",
      "docs/ui-guides/widget_matrix.md",
      "api/openapi.yaml"
    ],
    "deliverables": "Implementation-ready TypeScript registry skeleton, documentation describing mount lifecycle, instrumentation hooks, error boundaries, and theming approach.",
    "acceptance_criteria": "`mounts.ts` compiles, auto-mount logic documented, sample widget stub commits, and doc references tokens + analytics requirements.",
    "dependencies": [
      "I2.T2"
    ],
    "parallelizable": true,
    "done": false
  },
  {
    "task_id": "I2.T6",
    "iteration_id": "I2",
    "iteration_goal": "Translate architectural artifacts into actionable specs for personalized homepage delivery, covering user preference schemas, widget contracts, consent/merge UX flows, and initial OpenAPI definitions so frontend/backend squads can begin implementation in parallel.",
    "description": "Create AI Tagging & Feed Prioritization spec covering batching, budget enforcement, dedupe hashing, personalization ranking, and click tracking alignment for news widgets. Document fallback behaviors for budget thresholds per Policy P10.",
    "agent_type_hint": "DataArchitectureAgent",
    "inputs": "Job blueprint, widget matrix, AI budget policy.",
    "target_files": [
      "docs/architecture/ai_tagging_widget_spec.md"
    ],
    "input_files": [
      "docs/architecture/job_orchestration.md",
      "docs/ui-guides/widget_matrix.md",
      "docs/ops/ai_budget_monitoring.md"
    ],
    "deliverables": "Spec describing queue usage, scoring formula, caching windows, instrumentation, and user-facing badges for untagged stories.",
    "acceptance_criteria": "Document references AiUsageTracking fields, defines ranking weights, lists fallback UI cues, and enumerates monitoring metrics.",
    "dependencies": [
      "I2.T1"
    ],
    "parallelizable": true,
    "done": false
  },
  {
    "task_id": "I2.T7",
    "iteration_id": "I2",
    "iteration_goal": "Translate architectural artifacts into actionable specs for personalized homepage delivery, covering user preference schemas, widget contracts, consent/merge UX flows, and initial OpenAPI definitions so frontend/backend squads can begin implementation in parallel.",
    "description": "Produce Homepage QA & Telemetry plan describing unit/integration tests, accessibility audits, click-tracking validation, and feature flag cohort testing for personalization features.",
    "agent_type_hint": "QAAgent",
    "inputs": "Widget matrix, OpenAPI spec, mount architecture doc.",
    "target_files": [
      "docs/ops/homepage_validation_plan.md"
    ],
    "input_files": [
      "docs/ui-guides/widget_matrix.md",
      "api/openapi.yaml",
      "docs/ui-guides/ts_architecture.md"
    ],
    "deliverables": "Plan with test matrix, automation targets, manual exploratory guidelines, telemetry dashboards, and gating criteria for enabling widgets via feature flags.",
    "acceptance_criteria": "Document covers accessibility/performance/security checks, enumerates instrumentation requirements, and ties each test grouping to policies P2, P5, P7, P14.",
    "dependencies": [
      "I2.T5"
    ],
    "parallelizable": false,
    "done": false
  }
]